<!DOCTYPE html><html>
<head>
<title>Hic Et Nunc Explorer</title>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(["_setAccount", "UA-15384464-1"]);
  _gaq.push(["_trackPageview"]);

  (function() {
   var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;
   ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";
   var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);
   })();
</script>
<style>

img {
  object-fit: cover;
  width:300px;
  height:300px;
}
video{
  object-fit: cover;
  width:300px;
  height:300px;
}

div#outer {
  margin: auto;
  width:1200px;
}

div#menu{
  left: 0px;
  top:0px;
  position:fixed;
  width:120px;
}

.words {
background: #FFFFFF;
box-sizing: border-box;
color:: rgb(0, 0, 0);
cursor: pointer;
display: block;
font-family: "Courier New", Courier, monospace;
font-size: 16px;
font-stretch: 100%;
font-style: normal;
font-variant-caps: normal;
font-variant-east-asian: normal;
font-variant-ligatures: normal;
font-variant-numeric: normal;
font-weight: 400;
}

button {
background: #FFFFFF;
box-sizing: border-box;
color:: rgb(0, 0, 0);
cursor: pointer;
display: block;
font-family: "Courier New", Courier, monospace;
font-size: 16px;
font-stretch: 100%;
font-style: normal;
font-variant-caps: normal;
font-variant-east-asian: normal;
font-variant-ligatures: normal;
font-variant-numeric: normal;
font-weight: 400;
height: 24px;
letter-spacing: normal;
line-height: normal;
margin-bottom: 0px;
margin-left: 8px;
margin-right: 0px;
margin-top: 20px;
padding-bottom: 2px;
padding-left: 6px;
padding-right: 6px;
padding-top: 2px;
text-align: center;
text-indent: 0px;
text-rendering: auto;
text-shadow: none;
text-transform: none;
transition-delay: 0s, 0s;
transition-duration: 0.8s, 0.8s;
transition-property: border-color, color;
transition-timing-function: ease-out, ease-out;
user-select: none;
width: 177.234px;
word-spacing: 0px;
writing-mode: horizontal-tb;
-webkit-font-smoothing: antialiased;
-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
padding: 2px 6px;
color: #000;
border: #FFF;
border-right: 2px solid #000;
border-bottom: 2px solid #000;
transition: border-color .8s ease-out,color .8s ease-out;
}

button:focus {outline:none;}

</style>
<script>
  let thumbs = []; 
  
  function get_json(url, callback) {
    let xhr = new XMLHttpRequest();
    xhr.open('GET', url, true);
    xhr.responseType = 'json';
    xhr.onload = function() {
        const status = xhr.status;
        if (status == 200) {
            callback(null, xhr.response);
        } else {
            callback(status, xhr.response);
        }
    };
    xhr.send();
  };

  function filter_list(lower, upper, pred) {
    let result = [];
    for(let i in thumbs) {
      if(thumbs[i]["pr"]>=lower && thumbs[i]["pr"]<=upper && pred(thumbs[i])){
        result.push(thumbs[i]);
      }
    }
    return result;
  };
  function choose(l){ return l[Math.floor(Math.random() * l.length)] };

  let filtered_list = [];

  function getRandomInt(max) {
    return Math.floor(Math.random() * max);
  }

  function buildDOM(low, high) {
    const creators=4;
    let outer = document.getElementById("outer"); 
    outer.innerHTML="";
    offset=getRandomInt(3);
    for(c=0;c<3;c++) {
      let div = document.createElement("div");
      div.className = 'row';
      for(i=0;i<4;i++) {
        let a = document.createElement("a");
        a.href = ""; 
        a.target="_blank"
        a.rel="noopener noreferrer" 
        a.className = "nftlink";

        if((c+i+offset)%4 == 0) {
          let vid = document.createElement("video");
          vid.autoplay = true;
          vid.loop = true;
          vid.muted = true;
          vid.controls = false;
          vid.className = 'nft';
          a.appendChild(vid);
        } else {
          let img = document.createElement("img");
          img.className = 'nft';
          a.appendChild(img);
        }
        div.appendChild(a);
      }
      outer.appendChild(div);
    }
  };
  
  function replace(low, high) {
    possible_images = filter_list(low,high, function(m){ return m["e"]!="mp4"; } );
    possible_mp4    = filter_list(low,high, function(m){ return m["e"]=="mp4"; } );
    console.log(possible_images.length, possible_mp4.length);
    var nftlinks = document.getElementsByClassName('nftlink'); 
    var srcList = [];
    for(var i = 0; i < nftlinks.length; i++) {
      let chld = nftlinks[i].childNodes[0];
      if(chld.tagName == "IMG") {
        let randomNFT = choose(possible_images);
        chld.src = "artifacts/" + randomNFT["id"] + "." + randomNFT["e"]; 
        nftlinks[i].href="https://hicetnunc.xyz/objkt/" + randomNFT["id"];
      } else
      if(chld.tagName == "VIDEO") {
        let randomNFT = choose(possible_mp4);
        chld.src = "artifacts/" + randomNFT["id"] + ".mp4"; 
        nftlinks[i].href="https://hicetnunc.xyz/objkt/" + randomNFT["id"];
      }
    }
  }

  window.onload = function(){
    buildDOM();
    get_json("/thumbnails.json", function(status, response) {
      if(status) {
        console.log(status);
        console.log(response);
        return;
      }
      thumbs = response;
      replace(0,1000000);
    });    
  };

</script>
</head>

<body>

<div id="outer">


</div>
<div id="menu" class="but">
<button onclick="replace(0,100000);">
  <div id="cheap" class="but">
  Random
  </div>
</button>
<button onclick="replace(0,1);">
  <div id="cheap" class="but">
  below 1tez
  </div>
</button>
<button onclick="replace(1,10);">
  <div id="affordable" class="but">
  1 tez - 10tez
  </div>
</button>
<button onclick="replace(10,100);">
  <div id="medium" class="but">
  10 tez - 100 tez
  </div>
</button>
<button onclick="replace(100,100000);">
  <div id="expensive" class="but">
  above 100 tez
  </div>
</button>
</div>
<div class="words">
Created and maintained by <a href="https://www.twitter.com/mtyka">@mtyka</a>
</div>
</body>


</html>
